suite: deployment volume test
templates:
  - common.yaml
tests:
  - it: should pass with default values
    documentIndex: &deploymentDoc 0
    asserts:
      - hasDocuments:
          count: 3
      - isKind:
          of: Deployment
      - isNull:
          path: spec.template.spec.volume

  - it: should fail with wrong persistence type
    set:
      persistence:
        some_volume:
          type: not_valid_persistence
          enabled: true
          noMount: true
    asserts:
      - failedTemplate:
          errorMessage: Not a valid persistence.type (not_valid_persistence)
