suite: configmap data test
templates:
  - common.yaml
tests:
  - it: should pass with key-value data
    set:
      configmaps:
        my-configmap1:
          enabled: true
          data:
            foo: bar
    asserts:
      - documentIndex: &configmapDoc 0
        isKind:
          of: ConfigMap
      - documentIndex: *configmapDoc
        equal:
          path: data
          value:
            foo: bar

  - it: should pass with key-value data from tpl
    set:
      data: bar
      configmaps:
        my-configmap1:
          enabled: true
          data:
            foo: "{{ .Values.data }}"
    asserts:
      - documentIndex: *configmapDoc
        equal:
          path: data
          value:
            foo: bar

  - it: should pass with scalar data
    set:
      configmaps:
        my-configmap1:
          enabled: true
          data:
            foo: |
              some multi line
              string text
    asserts:
      - documentIndex: &configmapDoc 0
        isKind:
          of: ConfigMap
      - documentIndex: *configmapDoc
        equal:
          path: data
          value:
            foo: |-
              some multi line
              string text

  - it: should pass with scalar data with tpl
    set:
      data: some_text
      configmaps:
        my-configmap1:
          enabled: true
          data:
            foo: |
              Some other text
              {{ .Values.data }}
    asserts:
      - documentIndex: *configmapDoc
        equal:
          path: data
          value:
            foo: |-
              Some other text
              some_text
